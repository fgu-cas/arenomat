<!-- Modal -->
<div class="modal fade" id="modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
        </div> <!-- /.modal-content -->
    </div> <!-- /.modal-dialog -->
</div> <!-- /.modal -->

<div class="container">
	<div class="tab-content">
		<div id="tlogic" class="tab-pane fade in active">
			<div class="row">
				<div class="col-md-12">
					<div id="blockly" style="height: 1000px; width: 100%"></div>
				</div>
			</div>
		</div>

		<div id="tcamera" class="tab-pane fade">
			<div class="row">
				<div class="col-md-9">
					<div id="vision" style="width: {{ camHeight }}px; height: {{ camHeight }}px">
						<canvas id="webcam" width="{{ halfCamHeight }}" height="{{ halfCamHeight }}" style="width: {{ camHeight }}px; height: {{ camHeight }}px"></canvas>
					</div>
				</div>
<div class="col-md-3">
<div class="table-responsive">
<table class="table table-striped table-hover table-condensed">
<tr>
    <th>name</th>
    <th>attrs</th>
</tr>
<tr>
    <td><a href="0" class="active change">0</a></td><td></td>
</tr>
<tr>
    <td><a href="1" class="change">1</a></td><td></td>
</tr>
<tr>
    <td><a href="2" class="change">2</a></td><td></td>
</tr>
<tr>
    <td><a href="3" class="change">3</a></td><td></td>
</tr>
</table>
</div>

frames: <span id="cam_counter">0</span>, recognized: <span id="cv_counter">0</span>, fps: <span id="fps">0</span>

<div class="table-responsive">
<table id="custom_variables" class="table table-striped table-hover">
<tr>
    <th>name</th>
    <th>value</th>
</tr>
</table>
</div>
</div>
			</div>
		</div>

		<div id="tanalyze" class="tab-pane fade">

<img id="image" />
<br />
<input id="ex6" type="text" style="width: 640px" data-slider-min="1" data-slider-max="{{ frameCount }}" data-slider-step="1" data-slider-value="1" />
<br />
object 1 <span id="object_1">0,1</span><br />
object 2 <span id="object_2">0,1</span><br />
object 3 <span id="object_3">0,1</span><br />
object 4 <span id="object_4">0,1</span><br />
object 5 <span id="object_5">0,1</span><br />
object 6 <span id="object_6">0,1</span><br />
<div id="output"></div>
<br />
<br />
<br />
			
			
			
			
		</div>
		<div id="tsettings" class="tab-pane fade">
<div class="row">
				<div class="col-md-9">

			<form class="form-horizontal" role="form">
				<div class="form-group">
					<label for="dev" class="col-sm-2 control-label">Video device</label>
					<div class="col-sm-10">
						<input type="number" class="form-control" id="dev" placeholder="0">
					</div>
				</div>

				<div class="form-group">
					<label for="width" class="col-sm-2 control-label">Width</label>
					<div class="col-sm-10">
						<input type="number" class="form-control" id="width" placeholder="{{ camWidth }}">
					</div>
				</div>
				<div class="form-group">
					<label for="height" class="col-sm-2 control-label">Height</label>
					<div class="col-sm-10">
						<input type="number" class="form-control" id="height" placeholder="{{ camHeight }}">
					</div>
				</div>

				<div class="form-group">
					<label for="height" class="col-sm-2 control-label">Brightness</label>
					<div class="col-sm-10">
					    <input id="brightness" data-webcam="Brightness" class="webcam-control form-control" type="text" data-slider-min="1" data-slider-max="254" data-slider-step="1" data-slider-value="1" />
					</div>
				</div>
				<div class="form-group">
					<label for="height" class="col-sm-2 control-label">Exposure</label>
					<div class="col-sm-10">
					    <input id="exposure" data-webcam="Exposure auto" class="webcam-control form-control" type="text" data-slider-min="1" data-slider-max="254" data-slider-step="1" data-slider-value="1" />
					</div>
				</div>
				<div class="form-group">
					<label for="height" class="col-sm-2 control-label">Gain</label>
					<div class="col-sm-10">
					    <input id="gain" data-webcam="Gain" class="webcam-control form-control" type="text" data-slider-min="1" data-slider-max="254" data-slider-step="1" data-slider-value="1" />
					</div>
				</div>
				<div class="form-group">
					<label for="height" class="col-sm-2 control-label">Contrast</label>
					<div class="col-sm-10">
					    <input id="contrast" data-webcam="Contrast" class="webcam-control form-control" type="text" data-slider-min="1" data-slider-max="254" data-slider-step="1" data-slider-value="1" />
					</div>
				</div>
				<div class="form-group">
					<label for="height" class="col-sm-2 control-label">Focus</label>
					<div class="col-sm-10">
					    <input id="focus" data-webcam="Focus, absolute" class="webcam-control form-control" type="text" data-slider-min="1" data-slider-max="254" data-slider-step="1" data-slider-value="1" />
					</div>
				</div>



				<div class="form-group">
					<div class="col-sm-offset-2 col-sm-10">
						<button type="submit" class="btn btn-default">Save</button>
					</div>
				</div>
			</form>
			</div>
			<div class="col-md-3">
        			<canvas id="miniwebcam" width="{{ halfCamHeight }}" height="{{ halfCamHeight }}" style="width: 250px; height: 250px"></canvas>
			</div>
</div>
		    </div>
		</div>
	</div>


</div>

<script>
$( document ).ready(function() {
var timer;
var oldValue;

var brightnesstimer;
var brightnessoldValue;

function delayBrightness(control, value) {
    clearTimeout(brightnesstimer);
    brightnesstimer = setTimeout(function () {
	$.get('/settings/' + control + '/' + value, function( data ) {
	});
    }, 200);
}

function delayShow(value) {
    clearTimeout(timer);
    timer = setTimeout(function () {
	$.get('/frames/' + value, function( data ) {
//	    if (data.tracked) {
for(var n = 0; n < 7; n++) {
    var t = '';
  if (data.cv[n]) {
    t = data.cv[n].position.x + ', ' + data.cv[n].position.y;
  }
		$('#object_' + (n+1)).text(t);

		$('#output').text(JSON.stringify(data.output));
//}
}
             $("#image").attr("src",  'data:image/jpeg;base64,' + data.webcam);
	});
    }, 200);
}

$("#ex6").slider({
    tooltip: 'always'
});

$("#ex6").on('slide', function(slideEvt) {
    if (oldValue !== slideEvt.value) {
	oldValue = slideEvt.value;
        delayShow(slideEvt.value);
    }
});


$(".webcam-control")
  .slider({
    tooltip: 'always'
  })
  .on('slide', function(slideEvt) {
    if (brightnessoldValue !== slideEvt.value) {
	brightnessoldValue = slideEvt.value;
        delayBrightness($(this).data('webcam'), slideEvt.value);
    }
  });

    delayShow(1);

});
</script>


{{> blockly}}
